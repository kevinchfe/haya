<include file="Public/header"/>
<link rel="stylesheet" href="__PUBLIC__/simditor/styles/simditor.css"/>
<link rel="stylesheet" href="__PUBLIC__/webuploader/webuploader.css"/>
<link href="__PUBLIC__/Admin/css/plugins/switchery/switchery.css" rel="stylesheet">
<body>
<div id="wrapper">
    <include file="Public/nav"/>
    <div id="page-wrapper" class="gray-bg dashbard-1">
        <div class="row border-bottom">
            <include file="Public/sidebar"/>
        </div>
        <div class="wrapper wrapper-content">
            <!--面包屑-->
            <include file="Public/crumb"/>

            <div class="wrapper wrapper-content animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">

                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>商品添加</h5>
                            </div>
                            <div class="ibox-content">
                                <form method="post" class="form-horizontal" action="{:U('Admin/Goods/insertGoods')}">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">商品标题：</label>
                                        <div class="col-sm-6">
                                            <input type="text" name="goods_name" placeholder="请输入商品标题" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">是否为周新：</label>
                                        <div class="col-sm-6">
                                            <input type="checkbox" name="is_new" value="1" class="js-switch" checked />
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">本店价：</label>
                                        <div class="col-sm-6">
                                            <div class="input-group m-b">
                                                <input type="text" name="goods_price" data-mask="¥ 999,999,999.99" placeholder="请输入商品价格" class="form-control">
                                                <span class="input-group-addon">元</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">原价：</label>
                                        <div class="col-sm-6">
                                            <div class="input-group m-b">
                                                <input type="text" name="original_price" placeholder="请输入商品价格" class="form-control">
                                                <span class="input-group-addon">元</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">成本价：</label>
                                        <div class="col-sm-6">
                                            <div class="input-group m-b">
                                                <input type="text" name="cost_price" placeholder="请输入商品价格" class="form-control">
                                                <span class="input-group-addon">元</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">库存：</label>
                                        <div class="col-sm-6">
                                            <input type="text" name="goods_stock" placeholder="请输入商品库存" class="form-control">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">选择分类：</label>
                                        <div class="col-sm-6">
                                            <select class="form-control m-b" name="cat_id">
                                                <volist name="cat_list" id="cat_list">
                                                <option value="{$cat_list.id}">{$cat_list.cat_name}</option>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">选择品牌：</label>
                                        <div class="col-sm-6">
                                            <select class="form-control m-b" name="bid">
                                                <volist name="brand_list" id="cat_list">
                                                    <option value="{$cat_list.id}">{$cat_list.brand_name}</option>
                                                </volist>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">商品描述</label>
                                        <div class="col-sm-10">
                                            <textarea name="goods_desc" id="editor" placeholder="这里输入内容" autofocus style="margin: 0px; width: 1231px; height: 494px;">

                                            </textarea>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">商品图片：</label>
                                        <div class="col-sm-6">
                                            <!--用来存放item-->
                                            <div id="fileList" class="uploader-list"></div>
                                            <div class="clearfix"></div>
                                            <div id="filePicker">选择图片</div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-6" id="pic-item">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <div class="col-sm-4 col-sm-offset-2">
                                            <button class="btn btn-primary" type="submit">保存内容</button>
                                            <button class="btn btn-white" type="reset">取消</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
        <!--load footer-->
        <include file="Public/footer"/>
        <script type="text/javascript" src="__PUBLIC__/simditor/scripts/module.js"></script>
        <script type="text/javascript" src="__PUBLIC__/simditor/scripts/hotkeys.js"></script>
        <script type="text/javascript" src="__PUBLIC__/ueditor/ueditor.config.js"></script>
        <script type="text/javascript" src="__PUBLIC__/ueditor/ueditor.all.min.js"></script>
        <!-- Switchery -->
        <script src="__PUBLIC__/Admin/js/plugins/switchery/switchery.js"></script>
        <!--引入JS-->
        <script type="text/javascript" src="__PUBLIC__/webuploader/webuploader.js"></script>
        <script>
            var elem = document.querySelector('.js-switch');
            var switchery = new Switchery(elem, {
                color: '#1AB394'
            });

            var ue = UE.getEditor('editor');

            // 初始化Web Uploader
            var uploader = WebUploader.create({
                auto: true,
                swf: '__PUBLIC__/webuploader/Uploader.swf',
                server: "{:U('Admin/Goods/ajaxUploader')}",
                pick: '#filePicker',

                accept: {
                    title: 'Images',
                    extensions: 'gif,jpg,jpeg,bmp,png',
                    mimeTypes: 'image/*'
                }
            });
            uploader.on( 'uploadAccept', function( file, response ) {
                if(response._raw) {
                    var input = '<input type="hidden" name="pic_url[]" value="'+response._raw+'">';
                    $('#pic-item').append(input);
                }
            });

            uploader.on( 'fileQueued', function( file ) {
                var $li = $(
                                '<div id="' + file.id + '">' +
                                '<img class="thumbnail">'
                        ),
                        $img = $li.find('img');

                $('#fileList').append( $li );

                uploader.makeThumb( file, function( error, src ) {
                    if ( error ) {
                        $img.replaceWith('<span>不能预览</span>');
                        return;
                    }


                    $img.attr( 'src', src );
                }, 120, 100 );
            });

        </script>
